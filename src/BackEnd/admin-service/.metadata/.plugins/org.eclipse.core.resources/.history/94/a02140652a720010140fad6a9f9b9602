package com.example.demo.controllers;

import com.example.demo.entities.Events;
import com.example.demo.services.EventsService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/events")
@CrossOrigin(origins = "http://localhost:5173") // Adjust frontend port if needed
public class EventsController {

    @Autowired
    private EventsService eventsService;

    // ✅ 1. Get active events of a specific active club
    @GetMapping("/club/{clubId}")
    public List<Events> getActiveEventsByClub(@PathVariable int clubId) {
        return eventsService.getApprovedEventsByClubId(clubId);
    }

    // ✅ 2. Get all pending events (not approved) - admin only
    @GetMapping("/pending")
    public List<Events> getAllPendingEvents() {
        return eventsService.getAllPendingEvents();
    }

    // ✅ 3. Approve a specific event
    @PutMapping("/approve/{eventId}")
    public String approveEvent(@PathVariable int eventId) {
        boolean approved = eventsService.approveEvent(eventId);
        return approved ? "Event approved successfully" : "Event not found";
    }

    // ✅ 4. Reject/Delete a specific event
    @DeleteMapping("/delete/{eventId}")
    public String deleteEvent(@PathVariable int eventId) {
        boolean deleted = eventsService.deleteEvent(eventId);
        return deleted ? "Event deleted successfully" : "Event not found";
    }
}
